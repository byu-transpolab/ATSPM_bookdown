---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Findings
```{r setup, include = FALSE}
library(tidyverse)
library(modelsummary)
library(kableExtra)
```
During the analysis, several variables were found to have a statistically significant effect on traffic. Month of the year, the time period of the COVID-19 pandemic, and difference in traffic signals were all found to have a significant effect on vehicles per hour of phases 2 and 6 of the signals specified in the methods section. This is seen in Table \@ref(tab:general).

Each individual factor was given a fixed effects model to further investigate where significant factors occurred. Table \@ref(tab:FEmonth) shows that with January as the reference, each month, except for May, was statistically significant. Standard errors were similar across the year, with beta intercepts vary widely. The effect of day of the week though was the complete opposite. Table \@ref(tab:FEday) shows that day of the week had little to no affect on variations in hourly volume. Difference in whether or not a date was occuring after March 12, 2021, which was assumed to be the start of the COVID-19 pandemic shutdown in Utah, was shown to be significant in Table \@ref(tab:FECOVID). Individual signals were also shown to be significant in Table \@ref(tab:FESignal).

Like with any research, there were significant limitations to the data and analyses. Through the data cleaning process, it became very clear that many of the data provided were not complete or contained detector errors, leaving most of the data unusable. From 52 signals originally with data, only 7 were used in this analysis. Even with the most accurate data available, further detector error or unknown errors could be present. Other factors such as weather, holidays and major events, school openings, weather, and road conditions were not controlled for.

While not perfect, this analysis provides the conclusion that despite seasonal and signal specific variation, hourly volumes were significantly affected by the COVID-19 pandemic.

Note: The Methods section still needs to be updated to reflect the changes in methodology made in the last few days.


Base controls for Signals, COVID is base, but also controlling for COVID. Controls is Base controlling for everything, including day of week and month. R-squared value goes up, beta for COVID becomes more pronounced, quantify how much of an effect COVID had.

```{r general}
# Read in Volume dataset
Volume_reg <- read_rds("data/Volume_reg.rds")

# General Linear Regression Model
base <- lm(Volume_hour ~ factor(SignalId), data = Volume_reg)
covid_Base <- update(base, formula = . ~ . + COVID)
covid_controls <- update(covid_Base, formula = . ~ . + factor(month) + factor(day))

```

```{r modeltab}
modelsummary(list("Base" = base, "COVID" = covid_Base, "Controls" = covid_controls),
             estimate = "{estimate}{stars}", statistic = NULL, 
             output = 'kableExtra',
             gof_omit = 'IC|Log|Adj',
             coef_map = c(
               "(Intercept)" = "Intercept",
               "factor(SignalId)4090" = "4090",
               "factor(SignalId)4704" = "4704",
               "factor(SignalId)4705" = "4705",
               "factor(SignalId)6303" = "6303",
               "factor(SignalId)6304" = "6304",
               "factor(SignalId)6307" = "6307",
               "COVIDTRUE" = "COVID",
               "factor(month)2" = "February",
               "factor(month)3" = "March",
               "factor(month)4" = "April",
               "factor(month)5" = "May",
               "factor(month)6" = "June",
               "factor(month)7" = "July",
               "factor(month)8" = "August",
               "factor(month)9" = "September",
               "factor(month)10" = "October",
               "factor(month)11" = "November",
               "factor(month)12" = "December",
               "factor(day)4" = "Wednesday",
               "factor(day)5" = "Thursday")) %>%
  kable_styling() %>%
  row_spec(8, color = 'red') %>%
  group_rows("Signal", 2, 7) %>%
  group_rows("COVID-19", 8, 8) %>%
  group_rows("Month", 9, 19) %>%
  group_rows("Day", 20, 21)
```

